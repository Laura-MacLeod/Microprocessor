#include <xc.inc>
    
global  keypad_setup, keypad_read_row, keypad_read_column

psect	udata_acs   ; reserve data space in access ram
row:	    ds    1	    ; reserve 1 byte for variable UART_counter
column:	    ds    1
rowvals:    ds	  1
columnvals: ds	  1
    
psect	keypad_code,class=CODE


keypad_setup:
	movlb	15	    ;go to BSR 15
	bsf	REPU	    ;set pullup resistors high
	movlb	0	    ;return t0 access bank
	
	clrf	LATE
	return
	
	
	
keypad_read_row:
    
	movlw   0xf0
	movwf   TRISE

	movf	PORTE, W
	movff	PORTE, row
	
	movlw	0xf0	    
	cpfseq	row	;Compare keypad inputs to 00001111, if the same, skip
	movff   row, rowvals	;Stores value at row
	return			;Doesn't store value

keypad_read_column:

	movlw   0x0f
	movwf   TRISE
	
	movf	PORTE, W
	movff	PORTE, column
	
	movlw	0x0f	    
	cpfseq	column		    ;Compare keypad inputs to 11110000, if the same, skip
	movff   column, columnvals  ;Stores value at column
	return			    ;Doesn't store value
    

	
interpret:	; CURRENTLY WRONG, GOT CPFSEQ THE WRONG WAY AROUND
	
	movlw	01110000	; 4th row
	cpfseq	row
	bra	row4
    
	movlw	10110000	; 3rd row
	cpfseq	row
	bra	row3
	
	movlw	11010000	; 2nd row
	cpfseq	row
	bra	row2
	
	movlw	01110000	; 1st row
	cpfseq	row
	bra	row1
	
	retlw	0x00		; RETURN NULL
    
row1:
    
	movlw	00000111	; 4th column
	cpfseq	column
	;letter F
	 retlw	
    
	movlw	00001011	; 3rd column
	cpfseq	column
	;letter 3
	
	movlw	00001101	; 2nd column
	cpfseq	column
	;letter 2
	
	movlw	00001110	; 1st column
	cpfseq	column
	;letter 1
	
	return
    
row2:
    
	movlw	00000111	; 4th column
	cpfseq	column
	;letter E
    
	movlw	00001011	; 3rd column
	cpfseq	column
	;letter 6
	
	movlw	00001101	; 2nd column
	cpfseq	column
	;letter 5
	
	movlw	00001110	; 1st column
	cpfseq	column
	;letter 4
	
	return
    
row3:
    
	movlw	00000111	; 4th column
	cpfseq	column
	;letter D
    
	movlw	00001011	; 3rd column
	cpfseq	column
	;letter 9
	
	movlw	00001101	; 2nd column
	cpfseq	column
	;letter 8
	
	movlw	00001110	; 1st column
	cpfseq	column
	;letter 7
	
	return
    
row4:
    
	movlw	00000111	; 4th column
	cpfseq	column
	;letter C
    
	movlw	00001011	; 3rd column
	cpfseq	column
	;letter B
	
	movlw	00001101	; 2nd column
	cpfseq	column
	;letter 0
	
	movlw	00001110	; 1st column
	cpfseq	column
	;letter A
	
	return
    
